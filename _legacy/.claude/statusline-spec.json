{
  "name": "Claude Code Status Line",
  "version": "4.0",
  "description": "Dynamic status line for Claude Code CLI with dual-mode display and system resource monitoring (CPU/RAM/Disk)",

  "files": {
    "statusline": ".claude/statusline.js",
    "permissionAlert": ".claude/hooks/permission-alert.ps1",
    "settings": ".claude/settings.local.json",
    "aiConfig": "ai-models.json"
  },

  "modes": {
    "full": {
      "trigger": "terminal width >= 100 cols OR STATUSLINE_COMPACT != 1",
      "separator": "║",
      "sections": [
        {
          "id": "model",
          "label": "[TIER] ModelName",
          "example": "[PRO] Opus 4.5",
          "color": "tier-based (magenta/blue/green)"
        },
        {
          "id": "context",
          "label": "Context:XX%",
          "example": "Context:42%",
          "color": "green < 70% < yellow < 90% < red"
        },
        {
          "id": "tokens",
          "label": "Tokens:↑XX/↓XX",
          "example": "Tokens:↑45K/↓12K",
          "color": "blue=input, green=output"
        },
        {
          "id": "cache",
          "label": "Cache:XX%",
          "example": "Cache:78%",
          "color": "green >= 70%, yellow >= 40%, red < 40%",
          "formula": "cache_read_tokens / total_input_tokens * 100"
        },
        {
          "id": "limits",
          "label": "Limits:XX/YYtok XX/YYreq XXs",
          "example": "Limits:35K/40Ktok 94/100req 26s",
          "color": "remaining% based (green > 50% > yellow > 25% > red > 10% > blink)",
          "data": {
            "tokensRemaining": "tokensPerMinute - tokensUsedThisMinute",
            "tokensLimit": "from ai-models.json",
            "requestsRemaining": "requestsPerMinute - requestsThisMinute",
            "requestsLimit": "from ai-models.json",
            "resetTimer": "seconds until minute window resets"
          }
        },
        {
          "id": "cost",
          "label": "Cost:$X.XX",
          "example": "Cost:$0.450",
          "color": "green < $0.10 < yellow < $1.00 < red"
        },
        {
          "id": "lines",
          "label": "Lines:+XX/-YY",
          "example": "Lines:+120/-30",
          "color": "green=added, red=removed"
        },
        {
          "id": "mcp",
          "label": "MCP:[SDP]",
          "example": "MCP:[SDP]",
          "description": "S=Serena, D=Desktop Commander, P=Playwright",
          "color": "green=active"
        },
        {
          "id": "system",
          "label": "Sys:CPU X%(Nc) RAM X/YGB C: X/YGB",
          "example": "Sys:CPU 5%(12c) RAM 11.5/31.9GB C: 361/930GB",
          "description": "Real-time system resource monitoring",
          "color": "usage% based (green < 50% < yellow < 75% < red < 90% bold)",
          "data": {
            "cpu": {
              "percent": "100 - idle_time_percent across all cores",
              "cores": "os.cpus().length"
            },
            "ram": {
              "usedGB": "(os.totalmem() - os.freemem()) / 1024^3",
              "totalGB": "os.totalmem() / 1024^3",
              "percent": "usedMem / totalMem * 100"
            },
            "disk": {
              "usedGB": "Get-PSDrive C | .Used / 1024^3",
              "totalGB": "(Used + Free) / 1024^3",
              "freeGB": "Get-PSDrive C | .Free / 1024^3",
              "percent": "usedSpace / totalSpace * 100"
            }
          }
        },
        {
          "id": "hydra",
          "label": "HYDRA",
          "color": "rainbow animated"
        }
      ]
    },
    "compact": {
      "trigger": "terminal width < 100 cols OR STATUSLINE_COMPACT=1",
      "separator": "│",
      "sections": [
        {
          "id": "model",
          "label": "ShortName",
          "example": "Opus 4.5",
          "maxLength": 8
        },
        {
          "id": "context",
          "label": "XX%",
          "example": "42%"
        },
        {
          "id": "io",
          "label": "XX/YY",
          "example": "45K/12K"
        },
        {
          "id": "limits",
          "label": "XX/YYs",
          "example": "35K/26s"
        },
        {
          "id": "cost",
          "label": "$X.XX",
          "example": "$0.45"
        },
        {
          "id": "mcp",
          "label": "●●●",
          "description": "Green dots for each active MCP server"
        },
        {
          "id": "system",
          "label": "CX%/RY%/DZ%",
          "example": "C5%/R36%/D39%",
          "description": "CPU/RAM/Disk percentages",
          "color": "usage% based"
        }
      ]
    },
    "fallback": {
      "trigger": "No stdin data (standalone execution)",
      "example": "[STD] Regis ║ HYDRA ║ CPU 5% RAM 11.4/31.9GB C: 569GB free ║ FULL (120cols)",
      "sections": ["model", "hydra", "cpu", "ram", "disk_free", "mode_info"]
    }
  },

  "systemResources": {
    "version": "1.0",
    "description": "Real-time system monitoring added in v4",
    "metrics": {
      "cpu": {
        "source": "os.cpus()",
        "calculation": "100 - (totalIdle / totalTick * 100)",
        "refresh": "on each statusline render"
      },
      "ram": {
        "source": "os.totalmem(), os.freemem()",
        "calculation": "(total - free) / total * 100",
        "refresh": "on each statusline render"
      },
      "disk": {
        "source": "PowerShell Get-PSDrive C (Windows) / df (Unix)",
        "calculation": "used / (used + free) * 100",
        "refresh": "on each statusline render",
        "timeout": "3000ms",
        "fallback": "{ percent: 0, usedGB: '?', totalGB: '?', freeGB: '?' }"
      }
    },
    "colorThresholds": {
      "green": "0-49%",
      "yellow": "50-74%",
      "red": "75-89%",
      "redBold": "90-100%"
    }
  },

  "permissionAlert": {
    "version": "2.0 (FAST)",
    "trigger": "permission_prompt hook event",
    "timing": {
      "beeps": "2 short beeps (100ms + 150ms)",
      "toastDuration": "short",
      "taskbarFlash": "2 blinks (150ms each)"
    },
    "totalDuration": "~600ms (was ~1500ms)",
    "components": {
      "audio": {
        "beep1": { "frequency": 1500, "duration": 100 },
        "beep2": { "frequency": 1800, "duration": 150 }
      },
      "toast": {
        "title": "CLAUDE CODE",
        "message": "Wymaga potwierdzenia!",
        "sound": "ms-winsoundevent:Notification.Default"
      },
      "taskbar": {
        "flashes": 2,
        "interval": 150
      }
    }
  },

  "configuration": {
    "envVars": {
      "STATUSLINE_COMPACT": "Force compact mode when set to '1'"
    },
    "autoDetection": {
      "terminalWidth": "process.stdout.columns",
      "compactThreshold": 100
    },
    "dataFiles": {
      "usageTracking": "%TEMP%/claude-usage-tracking.json",
      "aiModels": "../ai-models.json",
      "settings": "./settings.local.json"
    }
  },

  "colorScheme": {
    "tiers": {
      "pro": { "color": "neonMagenta", "label": "PRO" },
      "standard": { "color": "neonBlue", "label": "STD" },
      "lite": { "color": "neonGreen", "label": "LITE" }
    },
    "thresholds": {
      "usage": { "ok": 70, "warn": 90 },
      "remaining": { "critical": 10, "low": 25, "medium": 50 },
      "cache": { "good": 70, "ok": 40 },
      "cost": { "low": 0.1, "high": 1.0 },
      "systemResources": { "ok": 50, "warn": 75, "critical": 90 }
    }
  },

  "changelog": {
    "v4.0": {
      "date": "2025-01-12",
      "changes": [
        "Added real-time CPU usage monitoring (percent + core count)",
        "Added real-time RAM usage monitoring (used/total GB)",
        "Added real-time Disk C: usage monitoring (used/total GB, free GB)",
        "New color thresholds for system resources (green/yellow/red/redBold)",
        "Windows: PowerShell Get-PSDrive for disk info",
        "Unix: df command for disk info",
        "Fallback display shows system resources"
      ]
    },
    "v3.0": {
      "changes": ["Added CPU and RAM monitoring (initial)"]
    },
    "v2.0": {
      "changes": ["Dual-mode display (full/compact)", "Rate limit tracking", "MCP status indicators"]
    }
  }
}
